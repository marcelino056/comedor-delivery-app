<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Comedor & Delivery</title>
    <link rel="manifest" href="/manifest.json">
    <link rel="stylesheet" href="/style.css">
    <meta name="theme-color" content="#3b82f6">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="Comedor & Delivery">
</head>
<body>
    <div id="app">
        <!-- Header -->
        <header class="header">
            <div class="header-left">
                <div class="empresa-info">
                    <div class="empresa-logo-container">
                        <img id="empresa-logo-header" src="" alt="Logo" class="empresa-logo hidden">
                    </div>
                    <div class="empresa-detalles">
                        <h1 id="empresa-nombre-header">Comedor & Delivery</h1>
                        <div class="empresa-meta">
                            <span id="empresa-rnc-header" class="empresa-rnc hidden"></span>
                            <span id="empresa-telefono-header" class="empresa-telefono hidden"></span>
                            <span id="empresa-direccion-header" class="empresa-direccion hidden"></span>
                        </div>
                    </div>
                </div>
                <button class="btn-config" onclick="abrirConfiguracion()" title="Configuraci√≥n de la Empresa">
                    ‚öôÔ∏è
                </button>
            </div>
            <div class="fecha-container">
                <p id="fecha-actual"></p>
                <div class="fecha-controls">
                    <button class="btn-fecha" onclick="cambiarFecha(-1)" title="D√≠a anterior">‚óÄ</button>
                    <input type="date" id="fecha-selector" onchange="cambiarFechaSeleccionada()" />
                    <button class="btn-fecha" onclick="cambiarFecha(1)" title="D√≠a siguiente">‚ñ∂</button>
                    <button class="btn-fecha btn-hoy" onclick="irAHoy()" title="Ir a hoy">HOY</button>
                </div>
            </div>
        </header>

        <!-- Navigation -->
        <nav class="nav-tabs">
            <button class="tab-btn active" data-tab="ventas">
                <span class="icon">üõí</span>
                <span>Ventas</span>
            </button>
            <button class="tab-btn" data-tab="ordenes">
                <span class="icon">üì¶</span>
                <span>Delivery</span>
            </button>
            <button class="tab-btn" data-tab="clientes">
                <span class="icon">üë•</span>
                <span>Clientes</span>
            </button>
            <button class="tab-btn" data-tab="facturas">
                <span class="icon">üìÑ</span>
                <span>Facturas</span>
            </button>
            <button class="tab-btn" data-tab="creditos">
                <span class="icon">üí≥</span>
                <span>Cr√©ditos</span>
            </button>
            <button class="tab-btn" data-tab="caja">
                <span class="icon">üí∞</span>
                <span>Caja</span>
            </button>
        </nav>

        <!-- Content -->
        <main class="content">
            <!-- Ventas Tab -->
            <div id="ventas-tab" class="tab-content active">
                <div class="tab-header">
                    <h2>Ventas Locales</h2>
                    <button class="btn-secondary" onclick="toggleHistorialVentas()">
                        <span class="icon">üìã</span>
                        <span>Historial</span>
                    </button>
                </div>
                
                <!-- Panel de Nueva Venta -->
                <div id="nueva-venta-panel" class="nueva-venta-panel">
                    <div class="venta-display">
                        <div class="venta-display-label">Monto de la Venta</div>
                        <div class="venta-display-amount" id="venta-display-amount">$0</div>
                    </div>
                    
                    <!-- Botones de Montos R√°pidos -->
                    <div class="quick-amounts">
                        <div class="quick-amounts-label">Montos R√°pidos</div>
                        <div class="quick-amounts-grid">
                            <button class="quick-amount-btn" onclick="establecerMonto(10)">$10</button>
                            <button class="quick-amount-btn" onclick="establecerMonto(25)">$25</button>
                            <button class="quick-amount-btn" onclick="establecerMonto(50)">$50</button>
                            <button class="quick-amount-btn" onclick="establecerMonto(100)">$100</button>
                            <button class="quick-amount-btn" onclick="establecerMonto(150)">$150</button>
                            <button class="quick-amount-btn" onclick="establecerMonto(175)">$170</button>
                            <button class="quick-amount-btn" onclick="establecerMonto(200)">$200</button>
                            <button class="quick-amount-btn" onclick="establecerMonto(225)">$225</button>
                            <button class="quick-amount-btn" onclick="establecerMonto(250)">$250</button>
                            <button class="quick-amount-btn" onclick="establecerMonto(300)">$300</button>
                            <button class="quick-amount-btn" onclick="establecerMonto(500)">$500</button>
                            <button class="quick-amount-btn" onclick="establecerMonto(1000)">$1000</button>
                        </div>
                    </div>
                    
                    <!-- M√©todos de Pago -->
                    <div class="payment-methods-grid">
                        <button class="payment-method-btn efectivo" onclick="procesarVenta('efectivo')">
                            <span class="payment-icon">üíµ</span>
                            <span class="payment-label">EFECTIVO</span>
                        </button>
                        <button class="payment-method-btn tarjeta" onclick="procesarVenta('tarjeta')">
                            <span class="payment-icon">üí≥</span>
                            <span class="payment-label">TARJETA</span>
                        </button>
                        <button class="payment-method-btn transferencia" onclick="procesarVenta('transferencia')">
                            <span class="payment-icon">üè¶</span>
                            <span class="payment-label">TRANSFERENCIA</span>
                        </button>
                    </div>
                    
                    <!-- Teclado Num√©rico -->
                    <div class="numeric-keypad">
                        <button class="keypad-btn" onclick="agregarDigito('1')">1</button>
                        <button class="keypad-btn" onclick="agregarDigito('2')">2</button>
                        <button class="keypad-btn" onclick="agregarDigito('3')">3</button>
                        <button class="keypad-btn" onclick="agregarDigito('4')">4</button>
                        <button class="keypad-btn" onclick="agregarDigito('5')">5</button>
                        <button class="keypad-btn" onclick="agregarDigito('6')">6</button>
                        <button class="keypad-btn" onclick="agregarDigito('7')">7</button>
                        <button class="keypad-btn" onclick="agregarDigito('8')">8</button>
                        <button class="keypad-btn" onclick="agregarDigito('9')">9</button>
                        <button class="keypad-btn keypad-clear" onclick="limpiarMonto()">C</button>
                        <button class="keypad-btn" onclick="agregarDigito('0')">0</button>
                        <button class="keypad-btn keypad-delete" onclick="borrarDigito()">‚å´</button>
                    </div>
                </div>

                <!-- Historial de Ventas -->
                <div id="historial-ventas" class="historial-ventas hidden">
                    <div class="historial-header">
                        <h3>Historial del D√≠a</h3>
                        <button class="btn-close" onclick="toggleHistorialVentas()">‚úï</button>
                    </div>
                    <div id="ventas-list" class="items-list"></div>
                </div>
            </div>

            <!-- √ìrdenes Tab -->
            <div id="ordenes-tab" class="tab-content">
                <div class="tab-header">
                    <h2>Delivery</h2>
                    <button class="btn-primary" onclick="openModal('orden')">
                        <span class="icon">‚ûï</span>
                        Agregar Delivery
                    </button>
                </div>
                
                <!-- Filtros -->
                <div class="filters-grid">
                    <button class="filter-btn active" data-filter="todos">
                        <span class="filter-label">TODOS</span>
                        <span class="filter-count" id="count-todos">0</span>
                    </button>
                    <button class="filter-btn filter-preparando" data-filter="preparando">
                        <span class="filter-label">PREPARANDO</span>
                        <span class="filter-count" id="count-preparando">0</span>
                    </button>
                    <button class="filter-btn filter-recibida" data-filter="recibida">
                        <span class="filter-label">RECIBIDA</span>
                        <span class="filter-count" id="count-recibida">0</span>
                    </button>
                    <button class="filter-btn filter-en-camino" data-filter="en-camino">
                        <span class="filter-label">EN CAMINO</span>
                        <span class="filter-count" id="count-en-camino">0</span>
                    </button>
                    <button class="filter-btn filter-entregada" data-filter="entregada">
                        <span class="filter-label">ENTREGADA</span>
                        <span class="filter-count" id="count-entregada">0</span>
                    </button>
                    <button class="filter-btn filter-anuladas" data-filter="anuladas">
                        <span class="filter-label">ANULADAS</span>
                        <span class="filter-count" id="count-anuladas">0</span>
                    </button>
                </div>

                <div id="filter-info" class="filter-info hidden"></div>
                <div id="ordenes-list" class="items-list"></div>
            </div>

            <!-- Clientes Tab -->
            <div id="clientes-tab" class="tab-content">
                <div class="tab-header">
                    <h2>Gesti√≥n de Clientes</h2>
                    <button class="btn-primary" onclick="openModal('cliente')">
                        <span class="icon">‚ûï</span>
                        Agregar Cliente
                    </button>
                </div>
                
                <div class="search-container">
                    <input type="text" id="buscar-cliente" placeholder="Buscar cliente por nombre, tel√©fono o RNC..." 
                           onkeyup="filtrarClientes()" class="search-input">
                </div>
                
                <div id="clientes-list" class="items-list"></div>
            </div>

            <!-- Facturas Tab -->
            <div id="facturas-tab" class="tab-content">
                <div class="tab-header">
                    <h2>Facturaci√≥n</h2>
                    <div class="header-buttons">
                        <button class="btn-primary" onclick="openModal('factura')">
                            <span class="icon">üìÑ</span>
                            Nueva Factura
                        </button>
                        <button class="btn-secondary" onclick="openModal('configuracion-rnc')">
                            <span class="icon">‚öôÔ∏è</span>
                            Config. RNC
                        </button>
                        <button class="btn-success" onclick="generarReporteRNC()">
                            <span class="icon">üìä</span>
                            Reporte RNC
                        </button>
                    </div>
                </div>
                
                <!-- Filtros de Facturas -->
                <div class="facturas-filters">
                    <div class="filter-group">
                        <label>Per√≠odo:</label>
                        <select id="filtro-periodo" onchange="filtrarFacturas()">
                            <option value="hoy">Hoy</option>
                            <option value="mes">Este mes</option>
                            <option value="personalizado">Personalizado</option>
                        </select>
                    </div>
                    <div class="filter-group" id="filtro-fechas" style="display: none;">
                        <input type="date" id="fecha-desde" onchange="filtrarFacturas()">
                        <span>hasta</span>
                        <input type="date" id="fecha-hasta" onchange="filtrarFacturas()">
                    </div>
                    <div class="filter-group">
                        <label>Tipo:</label>
                        <select id="filtro-tipo" onchange="filtrarFacturas()">
                            <option value="">Todos</option>
                            <option value="FACTURA">Facturas</option>
                            <option value="BOLETA">Boletas</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label>Con RNC:</label>
                        <select id="filtro-rnc" onchange="filtrarFacturas()">
                            <option value="">Todos</option>
                            <option value="true">Solo con RNC</option>
                        </select>
                    </div>
                </div>
                
                <div id="facturas-list" class="items-list"></div>
            </div>

            <!-- Cr√©ditos Tab -->
            <div id="creditos-tab" class="tab-content">
                <div class="tab-header">
                    <h2>Gesti√≥n de Cr√©ditos</h2>
                    <div class="header-buttons">
                        <button class="btn-primary" onclick="openModal('conduce')">
                            <span class="icon">üìù</span>
                            Nuevo Conduce
                        </button>
                        <button class="btn-success" onclick="openModal('pagar-creditos')">
                            <span class="icon">üí∞</span>
                            Pagar Cr√©ditos
                        </button>
                    </div>
                </div>

                <!-- Filtros de Cr√©ditos -->
                <div class="creditos-filters">
                    <div class="filter-group">
                        <label>Estado:</label>
                        <select id="filtro-estado-credito" onchange="filtrarCreditos()">
                            <option value="">Todos</option>
                            <option value="pendiente">Pendientes</option>
                            <option value="pagado">Pagados</option>
                            <option value="anulado">Anulados</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label>Cliente:</label>
                        <select id="filtro-cliente-credito" onchange="filtrarCreditos()">
                            <option value="">Todos los clientes</option>
                        </select>
                    </div>
                </div>

                <!-- Resumen de Cr√©ditos -->
                <div class="summary-grid creditos-summary">
                    <div class="summary-card orange">
                        <p class="summary-label">Cr√©ditos Pendientes</p>
                        <p class="summary-value" id="creditos-pendientes-total">$0</p>
                        <p class="summary-detail" id="creditos-pendientes-count">0 conduces</p>
                    </div>
                    <div class="summary-card green">
                        <p class="summary-label">Pagados Hoy</p>
                        <p class="summary-value" id="creditos-pagados-hoy">$0</p>
                        <p class="summary-detail" id="creditos-pagados-count">0 facturas</p>
                    </div>
                </div>

                <!-- Lista de Conduces -->
                <div id="conduces-list" class="items-list"></div>
            </div>

            <!-- Caja Tab -->
            <div id="caja-tab" class="tab-content">
                <div class="tab-header">
                    <h2>Control de Caja</h2>
                    <div class="header-buttons">
                        <button id="btn-reporte-diario" class="btn-success" onclick="generarReporteDiario()">
                            üìÑ Generar Reporte PDF
                        </button>
                        <button id="btn-monto-inicial" class="btn-secondary" onclick="openModal('montoInicial')">
                            <span class="btn-text">üí∞ Monto Inicial</span>
                        </button>
                        <button class="btn-danger" onclick="openModal('gasto')">
                            <span class="icon">‚ûñ</span>
                            Agregar Gasto
                        </button>
                    </div>
                </div>

                <!-- Resumen -->
                <div class="summary-grid">
                    <div class="summary-card blue">
                        <p class="summary-label">Monto Inicial</p>
                        <p class="summary-value" id="monto-inicial-display">$0</p>
                        <p class="summary-detail" id="monto-inicial-detail">Sin establecer</p>
                    </div>
                    <div class="summary-card green">
                        <p class="summary-label">Ventas Totales</p>
                        <p class="summary-value" id="ventas-totales">$0</p>
                        <p class="summary-detail" id="transacciones-total">0 transacciones</p>
                    </div>
                    <div class="summary-card red">
                        <p class="summary-label">Gastos</p>
                        <p class="summary-value" id="gastos-totales">$0</p>
                    </div>
                    <div class="summary-card purple">
                        <p class="summary-label">Ganancia</p>
                        <p class="summary-value" id="ganancia-total">$0</p>
                    </div>
                </div>

                <!-- Cuadre detallado -->
                <div class="detailed-summary">
                    <h3>üìä Resumen Completo del D√≠a</h3>
                    
                    <div class="payment-method efectivo">
                        <div class="method-header">
                            <span class="method-label">üíµ EFECTIVO</span>
                            <span class="method-total" id="efectivo-esperado">$0</span>
                        </div>
                        <div class="method-details">
                            <div class="detail-row">
                                <span>Monto inicial:</span>
                                <span id="detail-inicial">$0</span>
                            </div>
                            <div class="detail-row">
                                <span>+ Ventas efectivo:</span>
                                <span class="positive" id="detail-ventas-efectivo">+$0</span>
                            </div>
                            <div class="detail-row">
                                <span>- Gastos:</span>
                                <span class="negative" id="detail-gastos">-$0</span>
                            </div>
                        </div>
                    </div>

                    <div class="payment-method tarjeta">
                        <div class="method-header">
                            <span class="method-label">üí≥ TARJETA</span>
                            <span class="method-total" id="tarjeta-total">$0</span>
                        </div>
                        <p class="method-note" id="tarjeta-note">Verificar reportes del dat√°fono</p>
                    </div>

                    <div class="payment-method transferencia">
                        <div class="method-header">
                            <span class="method-label">üè¶ TRANSFERENCIAS</span>
                            <span class="method-total" id="transferencia-total">$0</span>
                        </div>
                        <p class="method-note" id="transferencia-note">Verificar extracto bancario</p>
                    </div>

                    <div class="payment-method creditos">
                        <div class="method-header">
                            <span class="method-label">üí≥ CR√âDITOS CREADOS HOY</span>
                            <span class="method-total" id="creditos-creados-total">$0</span>
                        </div>
                        <div class="method-details" id="creditos-creados-details">
                            <div class="detail-row">
                                <span>Conduces emitidos:</span>
                                <span id="detail-conduces-count">0 conduces</span>
                            </div>
                        </div>
                        <p class="method-note" id="creditos-note">Estos montos representan ventas a cr√©dito que a√∫n no han sido cobradas</p>
                    </div>

                    <div class="payment-method total">
                        <div class="method-header">
                            <span class="method-label">üí∞ TOTAL GENERAL</span>
                            <span class="method-total" id="total-general">$0</span>
                        </div>
                        <div class="method-details">
                            <div class="detail-row">
                                <span>Ganancia neta:</span>
                                <span id="ganancia-neta">$0</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Gastos del d√≠a -->
                <div class="gastos-section">
                    <h3>Gastos del D√≠a</h3>
                    <div id="gastos-list" class="gastos-list"></div>
                </div>
            </div>
        </main>
    </div>

    <!-- Templates de Modales -->
    <template id="template-cliente-modal">
        <form id="form-cliente" onsubmit="guardarCliente(event)">
            <div class="form-group">
                <label for="cliente-nombre">Nombre *</label>
                <input type="text" id="cliente-nombre" required>
            </div>
            <div class="form-group">
                <label for="cliente-telefono">Tel√©fono *</label>
                <input type="tel" id="cliente-telefono" required>
            </div>
            <div class="form-group">
                <label for="cliente-rnc">RNC (opcional)</label>
                <input type="text" id="cliente-rnc" placeholder="123456789">
            </div>
            <div class="form-group">
                <label for="cliente-direccion">Direcci√≥n</label>
                <textarea id="cliente-direccion" rows="3"></textarea>
            </div>
            <div class="form-group">
                <label for="cliente-email">Email</label>
                <input type="email" id="cliente-email">
            </div>
            
            <!-- Configuraci√≥n de Cr√©dito -->
            <div class="form-group">
                <label>
                    <input type="checkbox" id="cliente-credito-habilitado" onchange="toggleCreditoFields()"> 
                    Habilitar cr√©dito
                </label>
            </div>
            
            <div id="credito-fields" class="credito-config hidden">
                <div class="form-group">
                    <label for="cliente-limite-credito">L√≠mite de Cr√©dito ($)</label>
                    <input type="number" id="cliente-limite-credito" min="0" step="0.01" value="1000">
                </div>
                <div class="form-group">
                    <label for="cliente-dias-credito">D√≠as de Cr√©dito</label>
                    <input type="number" id="cliente-dias-credito" min="1" value="30">
                </div>
            </div>
            
            <div class="modal-actions">
                <button type="button" class="btn-secondary" onclick="closeModal()">Cancelar</button>
                <button type="submit" class="btn-primary">Guardar Cliente</button>
            </div>
        </form>
    </template>

    <template id="template-factura-modal">
        <form id="form-factura" onsubmit="generarFactura(event)">
            <div class="form-group">
                <label for="factura-cliente">Cliente *</label>
                <select id="factura-cliente" required onchange="actualizarDatosCliente()">
                    <option value="">Seleccionar cliente...</option>
                </select>
                <button type="button" class="btn-link" onclick="openModal('cliente')">+ Agregar nuevo cliente</button>
            </div>
            
            <div class="form-group">
                <label for="factura-tipo">Tipo de Comprobante *</label>
                <select id="factura-tipo" required onchange="toggleRNCOptions()">
                    <option value="BOLETA">Boleta (Sin RNC)</option>
                    <option value="FACTURA">Factura (Con RNC)</option>
                </select>
            </div>
            
            <div class="form-group">
                <label for="factura-metodo-pago">M√©todo de Pago *</label>
                <select id="factura-metodo-pago" required>
                    <option value="efectivo">üíµ Efectivo</option>
                    <option value="tarjeta">üí≥ Tarjeta</option>
                    <option value="transferencia">üè¶ Transferencia</option>
                </select>
            </div>
            
            <div id="rnc-options" class="form-group hidden">
                <label>
                    <input type="checkbox" id="requiere-rnc"> 
                    Requiere RNC para facturaci√≥n fiscal
                </label>
                <small class="form-hint">Solo marcar si el cliente necesita RNC para fines fiscales</small>
            </div>

            <div class="productos-section">
                <div class="section-header">
                    <h4>Productos/Servicios</h4>
                    <button type="button" class="btn-secondary btn-sm" onclick="agregarProductoFactura()">+ Agregar Producto</button>
                </div>
                <div id="productos-container">
                    <div class="producto-item">
                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-group-mobile-label">Descripci√≥n</label>
                                <input type="text" placeholder="Descripci√≥n *" class="producto-descripcion" required>
                            </div>
                            <div class="form-group">
                                <label class="form-group-mobile-label">Cantidad</label>
                                <input type="number" placeholder="Cant." class="producto-cantidad" min="1" value="1" required>
                            </div>
                            <div class="form-group">
                                <label class="form-group-mobile-label">Precio</label>
                                <input type="number" placeholder="Precio" class="producto-precio" step="0.01" min="0" required>
                            </div>
                            <div class="form-group">
                                <label class="form-group-mobile-label">Total</label>
                                <input type="number" placeholder="Total" class="producto-total" readonly>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="form-group">
                <label>
                    <input type="checkbox" id="factura-comprobante-fiscal" onchange="calcularTotalesFactura()"> 
                    Es comprobante fiscal (aplica ITBIS)
                </label>
                <small class="form-hint">Marcar solo si requiere aplicar ITBIS del 18%</small>
            </div>

            <div class="totales-section">
                <div class="total-row">
                    <span>Subtotal:</span>
                    <span id="factura-subtotal">$0.00</span>
                </div>
                <div class="total-row">
                    <span>ITBIS (18%):</span>
                    <span id="factura-impuesto">$0.00</span>
                </div>
                <div class="total-row total-final">
                    <span>TOTAL:</span>
                    <span id="factura-total">$0.00</span>
                </div>
            </div>

            <div class="modal-actions">
                <button type="button" class="btn-secondary" onclick="closeModal()">Cancelar</button>
                <button type="submit" class="btn-primary">Generar Factura</button>
            </div>
        </form>
    </template>

    <template id="template-configuracion-rnc-modal">
        <div class="configuraciones-existentes">
            <h4>Configuraciones Existentes</h4>
            <div class="configuraciones-rnc-list"></div>
        </div>
        
        <hr style="margin: 1rem 0;">
        
        <form id="form-configuracion-rnc" onsubmit="guardarConfiguracionRNC(event)">
            <h4>Agregar Nueva Configuraci√≥n</h4>
            <div class="form-group">
                <label for="rnc-nombre">Nombre de Secuencia *</label>
                <input type="text" id="rnc-nombre" placeholder="Ej: B01, B02, etc." required>
            </div>
            <div class="form-group">
                <label for="rnc-descripcion">Descripci√≥n *</label>
                <input type="text" id="rnc-descripcion" placeholder="Ej: Secuencia B01 - Facturas Comerciales" required>
            </div>
            <div class="form-group">
                <label for="rnc-prefijo">Prefijo *</label>
                <input type="text" id="rnc-prefijo" placeholder="Ej: B01" required>
            </div>
            <div class="form-row">
                <div class="form-group">
                    <label for="rnc-inicio">N√∫mero Inicial *</label>
                    <input type="number" id="rnc-inicio" min="1" value="1" required>
                </div>
                <div class="form-group">
                    <label for="rnc-final">N√∫mero Final *</label>
                    <input type="number" id="rnc-final" min="1" required>
                </div>
            </div>
            <div class="form-group">
                <label for="rnc-vencimiento">Fecha de Vencimiento *</label>
                <input type="date" id="rnc-vencimiento" required>
            </div>
            <div class="form-group">
                <label>
                    <input type="checkbox" id="rnc-activa" checked> 
                    Activar esta secuencia
                </label>
            </div>
            <div class="modal-actions">
                <button type="button" class="btn-secondary" onclick="closeModal()">Cancelar</button>
                <button type="submit" class="btn-primary">Guardar Configuraci√≥n</button>
            </div>
        </form>
    </template>

    <template id="template-reporte-rnc-modal">
        <form id="form-reporte-rnc" onsubmit="descargarReporteRNC(event)">
            <div class="form-group">
                <label for="reporte-mes">Mes *</label>
                <select id="reporte-mes" required>
                    <option value="1">Enero</option>
                    <option value="2">Febrero</option>
                    <option value="3">Marzo</option>
                    <option value="4">Abril</option>
                    <option value="5">Mayo</option>
                    <option value="6">Junio</option>
                    <option value="7">Julio</option>
                    <option value="8">Agosto</option>
                    <option value="9">Septiembre</option>
                    <option value="10">Octubre</option>
                    <option value="11">Noviembre</option>
                    <option value="12">Diciembre</option>
                </select>
            </div>
            <div class="form-group">
                <label for="reporte-anio">A√±o *</label>
                <input type="number" id="reporte-anio" min="2020" required>
            </div>
            <div class="modal-actions">
                <button type="button" class="btn-secondary" onclick="closeModal()">Cancelar</button>
                <button type="submit" class="btn-success">Descargar Reporte PDF</button>
            </div>
        </form>
    </template>

    <template id="template-conduce-modal">
        <form id="conduce-form" onsubmit="guardarConduce(event)">
            <div class="form-group">
                <label for="conduce-cliente">Cliente *</label>
                <select id="conduce-cliente" required onchange="verificarCreditoCliente()">
                    <option value="">Seleccione un cliente</option>
                </select>
                <button type="button" class="btn-link" onclick="openModal('cliente')">+ Agregar nuevo cliente</button>
            </div>
            
            <div id="credito-info" class="credit-info hidden">
                <div class="credit-status">
                    <div class="credit-item">
                        <span>L√≠mite de Cr√©dito:</span>
                        <span id="limite-credito">$0</span>
                    </div>
                    <div class="credit-item">
                        <span>Saldo Pendiente:</span>
                        <span id="saldo-pendiente">$0</span>
                    </div>
                    <div class="credit-item">
                        <span>Disponible:</span>
                        <span id="credito-disponible">$0</span>
                    </div>
                </div>
            </div>

            <div class="productos-section">
                <div class="section-header">
                    <h4>Productos/Servicios</h4>
                    <button type="button" class="btn-secondary btn-sm" onclick="agregarProductoConduce()">+ Agregar Producto</button>
                </div>
                <div id="productos-conduce" class="productos-list">
                    <div class="producto-item">
                        <div class="form-row">
                            <div class="form-group">
                                <input type="text" placeholder="Descripci√≥n *" name="descripcion" class="producto-descripcion" required>
                            </div>
                            <div class="form-group">
                                <input type="number" placeholder="Cant." name="cantidad" class="producto-cantidad" min="1" value="1" required onchange="calcularTotalConduce()">
                            </div>
                            <div class="form-group">
                                <input type="number" placeholder="Precio" name="precio" class="producto-precio" step="0.01" min="0" required onchange="calcularTotalConduce()">
                            </div>
                            <div class="form-group">
                                <input type="number" placeholder="Total" name="total" class="producto-total" readonly>
                            </div>
                            <button type="button" class="btn-danger btn-sm" onclick="eliminarProductoConduce(this)">‚úï</button>
                        </div>
                    </div>
                </div>
            </div>

            <div class="form-group">
                <label>
                    <input type="checkbox" id="conduce-comprobante-fiscal" onchange="calcularTotalConduce()"> 
                    Es comprobante fiscal (aplica ITBIS)
                </label>
                <small class="form-hint">Marcar solo si requiere aplicar ITBIS del 18%</small>
            </div>

            <div class="conduce-totals">
                <div class="total-item">
                    <span>Subtotal:</span>
                    <span id="conduce-subtotal">$0.00</span>
                </div>
                <div class="total-item">
                    <span>ITBIS (18%):</span>
                    <span id="conduce-impuesto">$0.00</span>
                </div>
                <div class="total-item total-final">
                    <span>Total:</span>
                    <span id="conduce-total">$0.00</span>
                </div>
            </div>

            <div class="modal-actions">
                <button type="button" class="btn-secondary" onclick="closeModal()">Cancelar</button>
                <button type="submit" class="btn-success" id="btn-guardar-conduce">Generar Conduce</button>
            </div>
        </form>
    </template>

    <template id="template-pagar-creditos-modal">
        <form id="pagar-creditos-form" onsubmit="pagarCreditos(event)">
            <div class="form-group">
                <label for="pago-cliente">Cliente *</label>
                <select id="pago-cliente" required onchange="cargarConducesPendientes()">
                    <option value="">Seleccione un cliente</option>
                </select>
            </div>

            <div id="conduces-pendientes" class="conduces-container hidden">
                <h4>Conduces Pendientes</h4>
                <div id="conduces-list-pago" class="conduces-checklist">
                    <!-- Lista de conduces pendientes con checkboxes -->
                </div>
                
                <div class="pago-summary">
                    <div class="summary-item">
                        <span>Conduces Seleccionados:</span>
                        <span id="conduces-seleccionados-count">0</span>
                    </div>
                    <div class="summary-item">
                        <span>Total a Pagar:</span>
                        <span id="total-pagar">$0.00</span>
                    </div>
                </div>

                <div class="form-group">
                    <label>
                        <input type="checkbox" id="generar-factura-rnc"> 
                        Generar factura con RNC
                    </label>
                </div>

                <div class="form-group">
                    <label for="metodo-pago-conduce">M√©todo de Pago *</label>
                    <select id="metodo-pago-conduce" required>
                        <option value="transferencia" selected>Transferencia</option>
                        <option value="efectivo">Efectivo</option>
                        <option value="tarjeta">Tarjeta</option>
                    </select>
                </div>
            </div>

            <div class="modal-actions">
                <button type="button" class="btn-secondary" onclick="closeModal()">Cancelar</button>
                <button type="submit" class="btn-success" id="btn-pagar-creditos" disabled>Procesar Pago</button>
            </div>
        </form>
    </template>

    <template id="template-exito-factura-modal">
        <div class="exito-factura-content">
            <div class="exito-icon">
                <div class="check-circle">‚úì</div>
            </div>
            
            <div class="exito-info">
                <h3>Factura generada exitosamente</h3>
                <div class="factura-details">
                    <div class="detail-item">
                        <span class="label">N√∫mero:</span>
                        <span class="value" id="factura-numero">-</span>
                    </div>
                    <div class="detail-item">
                        <span class="label">Total:</span>
                        <span class="value total" id="factura-total">$0.00</span>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="modal-actions exito-actions">
            <button type="button" class="btn-secondary" id="btn-cerrar-exito">Cerrar</button>
            <button type="button" class="btn-share" id="btn-compartir">üì§ Compartir</button>
            <button type="button" class="btn-primary" id="btn-descargar-pdf">üìÑ Descargar PDF</button>
        </div>
    </template>

    <template id="template-exito-conduce-modal">
        <div class="exito-factura-content">
            <div class="exito-icon">
                <div class="check-circle">‚úì</div>
            </div>
            
            <div class="exito-info">
                <h3>Conduce a cr√©dito generado exitosamente</h3>
                <div class="factura-details">
                    <div class="detail-item">
                        <span class="label">N√∫mero:</span>
                        <span class="value" id="conduce-numero">-</span>
                    </div>
                    <div class="detail-item">
                        <span class="label">Total:</span>
                        <span class="value total" id="conduce-total-modal">$0.00</span>
                    </div>
                    <div class="detail-item">
                        <span class="label">Estado:</span>
                        <span class="value" style="color: #f59e0b;">Pendiente de Pago</span>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="modal-actions exito-actions">
            <button type="button" class="btn-secondary" id="btn-cerrar-exito-conduce">Cerrar</button>
            <button type="button" class="btn-share" id="btn-compartir-conduce">üì§ Compartir</button>
            <button type="button" class="btn-primary" id="btn-descargar-conduce-pdf">üìÑ Descargar PDF</button>
        </div>
    </template>

    <!-- Template: Modal de Configuraci√≥n de Empresa -->
    <template id="template-configuracion-empresa-modal">
        <div class="form-grid">
            <div class="form-group">
                <label for="empresa-nombre">Nombre de la Empresa:</label>
                <input type="text" id="empresa-nombre" required>
            </div>
            
            <div class="form-group">
                <label for="empresa-direccion">Direcci√≥n:</label>
                <input type="text" id="empresa-direccion">
            </div>
            
            <div class="form-group">
                <label for="empresa-telefono">Tel√©fono:</label>
                <input type="tel" id="empresa-telefono">
            </div>
            
            <div class="form-group">
                <label for="empresa-rnc">RNC:</label>
                <input type="text" id="empresa-rnc">
            </div>
            
            <div class="form-group full-width">
                <label for="empresa-logo">Logo (opcional):</label>
                <input type="file" id="empresa-logo" accept="image/*">
                <small class="form-help">Selecciona una imagen para el logo de la empresa (aparecer√° en los PDFs)</small>
                <div id="logo-preview" class="logo-preview hidden">
                    <img id="logo-preview-img" src="" alt="Preview del logo">
                    <button type="button" class="btn-remove-logo" onclick="removerLogo()">‚úï Quitar logo</button>
                </div>
            </div>
        </div>
        
        <div class="modal-actions">
            <button class="btn btn-secondary" onclick="closeModal()">Cancelar</button>
            <button class="btn btn-primary" onclick="guardarConfiguracionEmpresa()">Guardar</button>
        </div>
    </template>

    <!-- Modal -->
    <div id="modal" class="modal hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="modal-title">Modal</h3>
                <button class="modal-close" onclick="closeModal()">‚úï</button>
            </div>
            <div class="modal-body" id="modal-body">
                <!-- Contenido din√°mico -->
            </div>
        </div>
    </div>

    <!-- Loading -->
    <div id="loading" class="loading hidden">
        <div class="spinner"></div>
    </div>

    <script src="/app.js"></script>
</body>
</html>
